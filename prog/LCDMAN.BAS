1 REM ALL VARS FOR 4-BIT MODE
2 E=64:REM 0100 0000
3 RW=32:REM 0010 0000
4 RS=16:REM 0001 0000

DDRA2 $4003 16387
PORTA2 $4001 16385
REM PORT A2 ALL PINS INPUT
POKE 16387,0
READ ALL PINS PORTA2
PRINT PEEK(16385)

10 REM INIT LCD ON VIA1 PORTB
14 REM DDRB1 $6002 24578 DEC
15 REM PORTB1 $6000 24576 DEC
20 POKE 24578,255:REM ALL OUTPUT PINS
25 
REM REMEMBER, ALL 4-BIT MODE
REM SET 4-BIT 0000 0010 LSB/HSB
POKE 24576,2:REM 0010 LSB
???POKE 24576,2+64:REM 
POKE 24576,0:REM 0000 HSB

POKE 24576,0
POKE 24576,64
POKE 24576,0
POKE 24576,0

PRINT PEEK(24576)

REM--PORTB1 ALL OUTPUT
POKE 24578,255

lcd_init:
  
  lda #%00000010 ; Set 4-bit mode D2
  sta PORTB1
POKE 24576,2
  ora #E D64
  sta PORTB1
POKE 24576,66
  and #%00001111 D2
  sta PORTB1
POKE 24576,2
  
  
POKE 24576,2
POKE 24576,66
POKE 24576,2

lcd_init:

REM lda #%00000010 ; Set 4-bit mode D2
POKE 24576,2:REM 4-BIT MODE
POKE 24576,66:REM SET E BIT
POKE 24576,2:REM CLEAR E BIT

  
LCD INSTRUCTION

REM lda #%00101000 ; Set 4-bit mode; 2-line display; 5x8 font
REM--SEND HIGH 4 BITS
POKE 24576,2:REM SEND HSB
POKE 24576,66:REM SET E BIT
POKE 24576,2:REM CLEAR E BIT
REM--SEND LOW 4 BITS
POKE 24576,8:REM LSB
POKE 24576,72:REM SET E BIT
POKE 24576,8:REM CLEAR E BIT


REM lda #%00001110 ; Display on; cursor on; blink off jsr 
REM--SEND HIGH 4 BITS
POKE 24576,0:REM SEND HSB
POKE 24576,64:REM SET E BIT
POKE 24576,0:REM CLEAR E BIT
REM--SEND LOW 4 BITS
POKE 24576,13:REM LSB
POKE 24576,77:REM SET E BIT
POKE 24576,13:REM CLEAR E BIT


REM lda #%00000110 ; entry mode set: Increment and shift cursor to right; don't shift display-no scrolling;

REM--SEND HIGH 4 BITS
POKE 24576,0:REM SEND HSB
POKE 24576,64:REM SET E BIT
POKE 24576,0:REM CLEAR E BIT
REM--SEND LOW 4 BITS
POKE 24576,6:REM LSB
POKE 24576,70:REM SET E BIT
POKE 24576,6:REM CLEAR E BIT


REM lda #$00000001 ; Clear display
REM--SEND HIGH 4 BITS
POKE 24576,0:REM SEND HSB
POKE 24576,64:REM SET E BIT
POKE 24576,0:REM CLEAR E BIT
REM--SEND LOW 4 BITS
POKE 24576,1:REM LSB
POKE 24576,65:REM SET E BIT
POKE 24576,1:REM CLEAR E BIT

1POKE 24576,0:REM CLR LCD
2POKE 24576,64
3POKE 24576,0
4POKE 24576,1
5POKE 24576,65
6POKE 24576,1
9END

REM ENTER PRESSED
REM #%10101000    1010 1000
REM--SEND HIGH 4 BITS
100POKE 24576,10:REM ENTER
101POKE 24576,74
102POKE 24576,10
103POKE 24576,8
104POKE 24576,70
105POKE 24576,8
109END


--END OF LCD INSTRUCTION



--SEND A CHAR
--0100 0001
REM--SEND HIGH 4 BITS
POKE 24576,4:REM SEND HSB
POKE 24576,20:REM SET RS BIT
POKE 24576,84:REM SET E BIT
POKE 24576,20:REM CLEAR E BIT
REM--SEND LOW 4 BITS
POKE 24576,1:REM LSB
POKE 24576,17:REM SET RS BIT
POKE 24576,81:REM SET E BIT
POKE 24576,17:REM CLEAR E BIT

10POKE 24576,4:REM SEND A
11POKE 24576,20
12POKE 24576,84
13POKE 24576,20
14POKE 24576,1
15POKE 24576,17
16POKE 24576,81
17POKE 24576,17
19END

--SEND B CHAR
--0100 0010
REM--SEND HIGH 4 BITS
POKE 24576,4:REM SEND HSB
POKE 24576,20:REM SET RS BIT
POKE 24576,84:REM SET E BIT
POKE 24576,20:REM CLEAR E BIT
REM--SEND LOW 4 BITS
POKE 24576,2:REM LSB
POKE 24576,18:REM SET RS BIT
POKE 24576,82:REM SET E BIT
POKE 24576,18:REM CLEAR E BIT

30POKE 24576,4:REM SEND B
31POKE 24576,20
32POKE 24576,84
33POKE 24576,20
34POKE 24576,2
35POKE 24576,18
36POKE 24576,82
37POKE 24576,18
39END

--SEND X CHAR
--0101 1000
REM--SEND HIGH 4 BITS
POKE 24576,5:REM SEND HSB
POKE 24576,21:REM SET RS BIT
POKE 24576,85:REM SET E BIT
POKE 24576,21:REM CLEAR E BIT
REM--SEND LOW 4 BITS
POKE 24576,8:REM LSB
POKE 24576,24:REM SET RS BIT
POKE 24576,88:REM SET E BIT
POKE 24576,24:REM CLEAR E BIT

--SEND X CHAR
--0101 1000

10 POKE 24576,5
20 POKE 24576,21
30 POKE 24576,85
40 POKE 24576,21
50 POKE 24576,8
60 POKE 24576,24
70 POKE 24576,88
80 POKE 24576,24

--SEND Q CHAR
--0001 0101  1 5

210 POKE 24576,1
220 POKE 24576,17
230 POKE 24576,81
240 POKE 24576,17
250 POKE 24576,5
260 POKE 24576,21
270 POKE 24576,85
280 POKE 24576,21

--SEND A CHAR
--0001 1100

10 POKE 24576,1
20 POKE 24576,17
30 POKE 24576,81
40 POKE 24576,17
50 POKE 24576,12
60 POKE 24576,28
70 POKE 24576,92
80 POKE 24576,28

2 E=64:REM 0100 0000
3 RW=32:REM 0010 0000
4 RS=16:REM 0001 0000